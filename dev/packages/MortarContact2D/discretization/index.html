<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Discretization and numerical integration of projection matrices · JuliaFEM.jl</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-83590644-1', 'auto');
ga('send', 'pageview');
</script><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link href="../../../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>JuliaFEM.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../../">Home</a></li><li><span class="toctext">User&#39;s guide</span></li><li><span class="toctext">Examples</span><ul><li><a class="toctext" href="../../../examples/2d_hertz_contact/">2D Hertz contact problem</a></li><li><a class="toctext" href="../../../examples/3d_frame/">Natural frequency analysis of 3d frame structure</a></li><li><a class="toctext" href="../../../examples/generate_stiffness_matrices/">Generating local matrices for problems</a></li><li><a class="toctext" href="../../../examples/linear_static/">JuliaFEM Linear Static Example</a></li></ul></li><li><span class="toctext">Developer&#39;s guide</span><ul><li><a class="toctext" href="../../FEMBase/mesh/">Mesh</a></li><li><a class="toctext" href="../../FEMBase/fields/">Fields</a></li><li><a class="toctext" href="../../FEMBase/basis/">Basis functions</a></li><li><a class="toctext" href="../../FEMBase/integration/">Integration</a></li><li><a class="toctext" href="../../FEMBase/elements/">Elements</a></li><li><a class="toctext" href="../../FEMBase/problems/">Problems</a></li><li><a class="toctext" href="../../FEMBase/solvers/">Analyses and solvers</a></li><li><a class="toctext" href="../../FEMBase/postprocessing/">Postprocessing</a></li><li><a class="toctext" href="../../FEMBase/results/">Results</a></li><li><a class="toctext" href="../../FEMBase/materials/">Materials</a></li></ul></li><li><span class="toctext">Description of packages</span><ul><li><a class="toctext" href="../../FEMBase/">FEMBase.jl</a></li><li><a class="toctext" href="../../AsterReader/">AsterReader.jl</a></li><li><a class="toctext" href="../../AbaqusReader/">AbaqusReader.jl documentation</a></li><li><a class="toctext" href="../../HeatTransfer/">HeatTransfer.jl</a></li><li><a class="toctext" href="../../FEMBeam/">Introduction</a></li><li><a class="toctext" href="../">MortarContact2D.jl</a></li><li><a class="toctext" href="../../MortarContact2DAD/">MortarContact2DAD.jl</a></li></ul></li><li><span class="toctext">API documentation</span><ul><li><a class="toctext" href="../../../api/">API documentation</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li><a href>Discretization and numerical integration of projection matrices</a></li></ul><a class="edit-page" href="https://github.com/JuliaFEM/JuliaFEM.jl/blob/master/docs/src/packages/MortarContact2D/discretization.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Discretization and numerical integration of projection matrices</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Discretization-and-numerical-integration-of-projection-matrices-1" href="#Discretization-and-numerical-integration-of-projection-matrices-1">Discretization and numerical integration of projection matrices</a></h1><p>[//]: # (This may be the most platform independent comment, and also 80 chars.)</p><p>In theoretical studies, we have a continuum setting where we evaluate the mandatory <a href="https://en.wikipedia.org/wiki/Line_integral">line integral</a>. When going towards a numerical implementation, this integral must be calculated in discretized setting, which is arising some practical questions. For example, displacement is defined using local coordinate system for each element. Thus, we need to find all master-slave pairs, contact segments, which  are giving contribution to the contact virtual work. Discretization of the  contact interface follows standard isoparametric approach. First we define  finite dimensional subspaces <span>$\boldsymbol{\mathcal{U}}_{h}^{\left(i\right)}$</span> and <span>$\boldsymbol{\mathcal{V}}_{h}^{\left(i\right)}$</span>, which are approximations of <span>$\boldsymbol{\mathcal{U}}^{\left(i\right)}$</span> and  <span>$\boldsymbol{\mathcal{V}}^{\left(i\right)}$</span>. Geometry and displacement  interpolation then goes as a following way: \begin{align} \boldsymbol{x}<em>{h}^{\left(1\right)} &amp; =\sum</em>{k=1}^{n^{\left(1\right)}}N<em>{k}^{\left(1\right)}\boldsymbol{x}</em>{k}^{\left(1\right)}, &amp; \boldsymbol{x}<em>{h}^{\left(2\right)} &amp; =\sum</em>{l=1}^{n^{\left(2\right)}}N<em>{l}^{\left(2\right)}\boldsymbol{x}</em>{l}^{\left(2\right)}, \\
\boldsymbol{u}<em>{h}^{\left(1\right)} &amp; =\sum</em>{k=1}^{n^{\left(1\right)}}N<em>{k}^{\left(1\right)}\boldsymbol{d}</em>{k}^{\left(1\right)}, &amp; \boldsymbol{u}<em>{h}^{\left(2\right)} &amp; =\sum</em>{l=1}^{n^{\left(2\right)}}N<em>{l}^{\left(2\right)}\boldsymbol{d}</em>{l}^{\left(2\right)}. \end{align}</p><p>Moreover, we need also to interpolate Lagrange multipliers in the interface: \begin{equation} \boldsymbol{\lambda}<em>{h}=\sum</em>{j=1}^{m^{\left(1\right)}}\Phi<em>{j}\boldsymbol{\lambda}</em>{j}. \end{equation}</p><pre><code class="language-julia">function f(x)
    return x
end</code></pre><p>Substituting interpolation polynomials to contact virtual work <span>$\delta\mathcal{W}_{\mathrm{co}}$</span> yields \begin{align} -\delta\mathcal{W}<em>{\mathrm{co}} &amp; =\int</em>{\gamma<em>{\mathrm{c}}^{\left(1\right)}}\boldsymbol{\lambda}\cdot\left(\delta\boldsymbol{u}^{\left(1\right)}-\delta\boldsymbol{u}^{\left(2\right)}\circ\chi\right)\,\mathrm{d}a\nonumber \
 &amp; \approx\int</em>{\gamma<em>{\mathrm{c},h}^{\left(1\right)}}\boldsymbol{\lambda}</em>{h}\cdot\left(\delta\boldsymbol{u}<em>{h}^{\left(1\right)}-\delta\boldsymbol{u}</em>{h}^{\left(2\right)}\circ\chi<em>{h}\right)\,\mathrm{d}a\nonumber \
 &amp; =\int</em>{\gamma<em>{\mathrm{c},h}^{\left(1\right)}}\left(\sum</em>{j=1}^{m^{\left(1\right)}}\Phi<em>{j}\boldsymbol{\lambda}</em>{j}\right)\cdot\left(\sum<em>{k=1}^{n^{\left(1\right)}}N</em>{k}^{\left(1\right)}\delta\boldsymbol{d}<em>{k}^{\left(1\right)}-\sum</em>{l=1}^{n^{\left(2\right)}}\left(N<em>{l}^{\left(2\right)}\circ\chi</em>{h}\right)\delta\boldsymbol{d}<em>{l}^{\left(2\right)}\right)\,\mathrm{d}a\nonumber \
 &amp; =\sum</em>{j=1}^{m^{\left(1\right)}}\sum<em>{k=1}^{n^{\left(1\right)}}\boldsymbol{\lambda}</em>{j}\cdot\int<em>{\gamma</em>{\mathrm{c},h}^{\left(1\right)}}\Phi<em>{j}N</em>{k}^{\left(1\right)}\delta\boldsymbol{d}<em>{k}^{\left(1\right)}\,\mathrm{d}a-\sum</em>{j=1}^{m^{\left(1\right)}}\sum<em>{l=1}^{n^{\left(2\right)}}\boldsymbol{\lambda}</em>{j}\cdot\int<em>{\gamma</em>{\mathrm{c},h}^{\left(1\right)}}\Phi<em>{j}\left(N</em>{l}^{\left(2\right)}\circ\chi<em>{h}\right)\delta\boldsymbol{d}</em>{l}^{\left(2\right)}\,\mathrm{d}a\nonumber \
 &amp; =\sum<em>{j=1}^{m^{\left(1\right)}}\sum</em>{k=1}^{n^{\left(1\right)}}\boldsymbol{\lambda}<em>{j}^{\mathrm{T}}\left(\int</em>{\gamma<em>{\mathrm{c},h}^{\left(1\right)}}\Phi</em>{j}N<em>{k}^{\left(1\right)}\,\mathrm{d}a\right)\delta\boldsymbol{d}</em>{k}^{\left(1\right)}-\sum<em>{j=1}^{m^{\left(1\right)}}\sum</em>{l=1}^{n^{\left(2\right)}}\boldsymbol{\lambda}<em>{j}^{\mathrm{T}}\left(\int</em>{\gamma<em>{\mathrm{c},h}^{\left(1\right)}}\Phi</em>{j}\left(N<em>{l}^{\left(2\right)}\circ\chi</em>{h}\right)\,\mathrm{d}a\right)\delta\boldsymbol{d}<em>{l}^{\left(2\right)}.\label{2d</em>projection:eq:discretized<em>contact</em>virtual_work} \end{align}</p><p>Here, <span>$\chi_{h}:\gamma_{\mathrm{c},h}^{\left(1\right)}\mapsto\gamma_{\mathrm{c},h}^{\left(2\right)}$</span> is a discrete mapping from the slave surface to the master surface. From the equation \ref{2d<em>projection:eq:discretized</em>contact<em>virtual</em>work}, we find the so called mortar matrices, commonly denoted as <span>$\boldsymbol{D}$</span> and <span>$\boldsymbol{M}$</span>: \begin{align} \boldsymbol{D}\left[j,k\right] &amp; =D<em>{jk}\boldsymbol{I}</em>{\mathrm{ndim}}=\int<em>{\gamma</em>{\mathrm{c},h}^{\left(1\right)}}\Phi<em>{j}N</em>{k}^{\left(1\right)}\,\mathrm{d}a\boldsymbol{I}<em>{\mathrm{ndim}}, &amp; j=1,\ldots,m^{\left(1\right)}, &amp; k=1,\ldots,n^{\left(1\right)},\
\boldsymbol{M}\left[j,l\right] &amp; =M</em>{jl}\boldsymbol{I}<em>{\mathrm{ndim}}=\int</em>{\gamma<em>{\mathrm{c},h}^{\left(1\right)}}\Phi</em>{j}\left(N<em>{l}^{\left(2\right)}\circ\chi</em>{h}\right)\,\mathrm{d}a\boldsymbol{I}_{\mathrm{ndim}}, &amp; j=1,\ldots,m^{\left(1\right)}, &amp; l=1,\ldots,n^{\left(2\right)}. \end{align}</p><p>The process of discretizing mesh tie virtual work  <span>$\delta\mathcal{W}_{\mathrm{mt}}$</span>, is identical to what is now presented, with a difference that integrals are evaluated in reference configuration instead of current configuration. Also, when considering linearized kinematic and small deformations, integration can be done in reference configuration. For mesh tie contact, the discretized contact virtual work is \begin{align} -\delta\mathcal{W}<em>{\mathrm{mt},h}= &amp; \sum</em>{j=1}^{m^{\left(1\right)}}\sum<em>{k=1}^{n^{\left(1\right)}}\boldsymbol{\lambda}</em>{j}^{\mathrm{T}}\left(\int<em>{\Gamma</em>{\mathrm{c},h}^{\left(1\right)}}\Phi<em>{j}N</em>{k}^{\left(1\right)}\,\mathrm{d}A<em>{0}\right)\delta\boldsymbol{d}</em>{k}^{\left(1\right)}\nonumber \
 &amp; -\sum<em>{j=1}^{m^{\left(1\right)}}\sum</em>{l=1}^{n^{\left(2\right)}}\boldsymbol{\lambda}<em>{j}^{\mathrm{T}}\left(\int</em>{\Gamma<em>{\mathrm{c},h}^{\left(1\right)}}\Phi</em>{j}\left(N<em>{l}^{\left(2\right)}\circ\chi</em>{h}\right)\,\mathrm{d}A<em>{0}\right)\delta\boldsymbol{d}</em>{l}^{\left(2\right)}.\label{eq:2d<em>projection:discretized</em>virtual_work} \end{align}</p><footer><hr/></footer></article></body></html>
